# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ Telegram Bot

## –û–±–∑–æ—Ä

–î–ª—è –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–Ω –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –Ω–∞ Jest, –ø—Ä–æ–≤–µ—Ä—è—é—â–∏–π –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –±–æ—Ç–∞.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

–¢–µ—Å—Ç—ã —Ä–∞–∑–º–µ—â–µ–Ω—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `__tests__/` –∏ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã –ø–æ –º–æ–¥—É–ª—è–º:

```
__tests__/
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ containsEmojiOrUnicode.test.js
‚îÇ   ‚îú‚îÄ‚îÄ divideIntoTeams.test.js
‚îÇ   ‚îî‚îÄ‚îÄ telegramUtils.test.js
‚îú‚îÄ‚îÄ store/
‚îÇ   ‚îî‚îÄ‚îÄ index.test.js
‚îú‚îÄ‚îÄ message/
‚îÇ   ‚îú‚îÄ‚îÄ buildPlayingTeamsMessage.test.js
‚îÇ   ‚îî‚îÄ‚îÄ buildTeamsMessage.test.js
‚îú‚îÄ‚îÄ buttons/
‚îÇ   ‚îî‚îÄ‚îÄ createTeamButtons.test.js
‚îî‚îÄ‚îÄ setup.js
```

## –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
npm test

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã –≤ —Ä–µ–∂–∏–º–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è
npm run test:watch

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
npm run test:coverage
```

## –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

### –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–∫—Ä—ã—Ç—ã–µ –º–æ–¥—É–ª–∏:

1. **utils/divideIntoTeams.js** (100%)
   - –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤ –Ω–∞ –∫–æ–º–∞–Ω–¥—ã
   - –ê–ª–≥–æ—Ä–∏—Ç–º "–∑–º–µ–π–∫–∏" –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É
   - –ö—Ä–∞–π–Ω–∏–µ —Å–ª—É—á–∞–∏ (–ø—É—Å—Ç—ã–µ –º–∞—Å—Å–∏–≤—ã, null, undefined)

2. **utils/telegramUtils.js** (100%)
   - –£—Å–ø–µ—à–Ω—ã–µ –≤—ã–∑–æ–≤—ã Telegram API
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ "message is not modified"
   - –ü–æ–≤—Ç–æ—Ä—ã –ø—Ä–∏ rate limit (429)
   - –ü–æ–≤—Ç–æ—Ä—ã –ø—Ä–∏ gateway timeout (504)
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –æ—à–∏–±–æ–∫

3. **buttons/createTeamButtons.js** (100%)
   - –°–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –¥–ª—è –∏–≥—Ä–æ–∫–æ–≤
   - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ 2 –≤ —Ä—è–¥
   - –¶–≤–µ—Ç–∞ –∫–æ–º–∞–Ω–¥
   - Callback –¥–∞–Ω–Ω—ã–µ

4. **store/index.js** (90.26%)
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∏–≥—Ä–æ–∫–æ–≤
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–∞–º–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –º–∞—Ç—á–∞
   - –ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä–æ–∫–æ–≤
   - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∞—Ç—á–µ–π

5. **message/buildTeamsMessage.js** (93.22%)
   - –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –æ –∫–æ–º–∞–Ω–¥–∞—Ö
   - –¢–∞–±–ª–∏—Ü–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
   - MVP –∏–≥—Ä–æ–∫–∏
   - –†–µ–π—Ç–∏–Ω–≥–∏ –∏ –≥–æ–ª—ã
   - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º–µ–Ω

6. **message/buildPlayingTeamsMessage.js** (100%)
   - –°–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –∏–≥—Ä–∞—é—â–∏—Ö –∫–æ–º–∞–Ω–¥
   - –ò—Ç–æ–≥–∏ –º–∞—Ç—á–µ–π
   - –°—á–µ—Ç –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
   - –†–∞–∑–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö

7. **utils/containsEmojiOrUnicode.js** (100%)
   - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —ç–º–æ–¥–∑–∏
   - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ Unicode —Å–∏–º–≤–æ–ª–æ–≤
   - –í–∞–ª–∏–¥–∞—Ü–∏—è username –∏ –∏–º–µ–Ω

## –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤

### Utils Tests (60 —Ç–µ—Å—Ç–æ–≤)

**divideIntoTeams:**
- ‚úÖ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ 2, 3, 4 –∫–æ–º–∞–Ω–¥—ã
- ‚úÖ –ê–ª–≥–æ—Ä–∏—Ç–º "–∑–º–µ–π–∫–∏"
- ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ù–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
- ‚úÖ –ù–µ–º–∞—Ç–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**telegramUtils:**
- ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –≤—ã–∑–æ–≤—ã
- ‚úÖ –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ "message is not modified"
- ‚úÖ –ü–æ–≤—Ç–æ—Ä—ã –ø—Ä–∏ 429/504
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±—Ä–æ—Å –¥—Ä—É–≥–∏—Ö –æ—à–∏–±–æ–∫
- ‚úÖ –ö–∞—Å—Ç–æ–º–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫

### Store Tests (30 —Ç–µ—Å—Ç–æ–≤)

**GlobalState:**
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞–º–∏ –∏ –æ—á–µ—Ä–µ–¥—å—é
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–∞–º–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
- ‚úÖ –°–æ—Å—Ç–æ—è–Ω–∏–µ –º–∞—Ç—á–∞
- ‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä–æ–∫–æ–≤ –∏ –º–∞—Ç—á–µ–π
- ‚úÖ –õ–æ–∫–∞—Ü–∏—è –∏ —Å—É–¥—å—è

### Message Tests (47 —Ç–µ—Å—Ç–æ–≤)

**buildTeamsMessage:**
- ‚úÖ –ë–∞–∑–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π
- ‚úÖ MVP –∏–≥—Ä–æ–∫–∏
- ‚úÖ –†–µ–π—Ç–∏–Ω–≥–∏ —Å –∏–∫–æ–Ω–∫–∞–º–∏
- ‚úÖ –ì–æ–ª—ã –∏–≥—Ä–æ–∫–æ–≤
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º–µ–Ω
- ‚úÖ –¶–≤–µ—Ç–∞ –∫–æ–º–∞–Ω–¥

**buildPlayingTeamsMessage:**
- ‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –∏–≥—Ä–∞—é—â–∏—Ö –∫–æ–º–∞–Ω–¥
- ‚úÖ –ò—Ç–æ–≥–∏ –º–∞—Ç—á–µ–π
- ‚úÖ –°—á–µ—Ç –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–ø–æ–±–µ–¥–∞/–Ω–∏—á—å—è)
- ‚úÖ –†–∞–∑–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ù—É–º–µ—Ä–∞—Ü–∏—è –∏–≥—Ä–æ–∫–æ–≤

### Buttons Tests (28 —Ç–µ—Å—Ç–æ–≤)

**createTeamButtons:**
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –¥–ª—è –∏–≥—Ä–æ–∫–æ–≤
- ‚úÖ –¶–≤–µ—Ç–∞ –∫–æ–º–∞–Ω–¥ (üî¥üîµüü¢üü°)
- ‚úÖ Callback –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ 2 –≤ —Ä—è–¥
- ‚úÖ –ù—É–º–µ—Ä–∞—Ü–∏—è –∏–≥—Ä–æ–∫–æ–≤
- ‚úÖ –ö—Ä–∞–π–Ω–∏–µ —Å–ª—É—á–∞–∏

## –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤:** 145
- **–£—Å–ø–µ—à–Ω—ã—Ö:** 145
- **–ü—Ä–æ–≤–∞–ª–µ–Ω–Ω—ã—Ö:** 0
- **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~2.5 —Å–µ–∫—É–Ω–¥—ã

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–î–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø–æ–∫—Ä—ã—Ç–∏—è –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è:

1. Command handlers (add.js, play.js, finish.js –∏ –¥—Ä.)
2. Database operations (getPlayerStats.js, savePlayers.js)
3. Utility functions (checkTimeAndNotify, sendPlayerList –∏ –¥—Ä.)
4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å mock Telegram API

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

Jest –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ `jest.config.js`:
- Test environment: Node.js
- Setup —Ñ–∞–π–ª –¥–ª—è env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- Coverage reports: text, lcov, html
- Verbose mode –≤–∫–ª—é—á–µ–Ω

